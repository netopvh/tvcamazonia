"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,r,s=[],d=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;d=!1}else for(;!(d=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);d=!0);}catch(e){l=!0,i=e}finally{try{if(!d&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(l)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(i){window.haHasIconLibrary=function(){return elementor.helpers&&elementor.helpers.renderIcon},window.haGetFeatureLabel=function(e){var t=document.createElement("DIV");return t.innerHTML=e,20<(e=t.textContent||t.innerText||e).length?e.substring(0,20)+"...":e},window.haGetTranslated=function(e,t){return elementorCommon.translate(e,null,t,HappyAddonsEditor.i18n)};elementor.hooks.addFilter("element/view",function(e,t){var n;return"widget"===(t=t).get("elType")&&"ha-hotspots"===t.get("widgetType")?e.extend((n=e,{initialize:function(){n.prototype.initialize.apply(this,arguments),this.updateContextMenu(),this.addedByContextMenuData=null,this.listenTo(elementor.channels.dataEditMode,"switch",this.toggleSpotDragMode),this.listenTo(this.model.get("editSettings"),"change:activeItemIndex",this.onEditSettingsChange),this.listenTo(this.model.get("settings").get("spots"),"add",this.handleAddedByContextMenu)},handleAddedByContextMenu:function(e){var t=elementorFrontend.getCurrentDeviceMode(),t="desktop"===t?"":"_"+t,n="x_pos",o="y_pos",i={},a=this.$el.width(),r=this.$el.height(),s=this.addedByContextMenuData&&this.addedByContextMenuData.offsetX,d=this.addedByContextMenuData&&this.addedByContextMenuData.offsetY,l=e.get(n+t).unit,u=e.get(o+t).unit;_.isNull(this.addedByContextMenuData)||(s=(100*s/a).toFixed(2),d=(100*d/r).toFixed(2),i[n+t]={size:s,unit:l},i[o+t]={size:d,unit:u},e.setExternalChange(i),this.renderStyles(),this.addedByContextMenuData=null)},updateContextMenu:function(){var e=this.getBehavior("contextMenu"),t=e.getOption("groups"),n=_.findWhere(t,function(e){return"general"===e.name}),o=_.findIndex(n.actions,function(e){return"ha-add-hotspot"===e.name}),i=this;-1===o&&n.actions.push({name:"ha-add-hotspot",title:"Add Hotspot",icon:"hm hm-happyaddons",callback:function(){i.model.trigger("request:edit"),i.getSpotsView().onButtonAddRowClick()}}),e.options.groups=t,e.initContextMenu()},onEditSettingsChange:function(e){this.$el.find('[data-index="'+(e.get("activeItemIndex")-1)+'"]').addClass("ha-hotspots__item--focus").siblings(".ha-hotspots__item--focus").removeClass("ha-hotspots__item--focus")},getControlViewByName:function(t){return elementor.getPanelView().getCurrentPageView().children.find(function(e){return e.model.get("name")===t})},getSpotsView:function(){return $e.routes.isPartOf("panel/editor/content")||$e.route("panel/editor/content",{model:this.getContainer().model,view:this.getContainer().view}),"_section_spots"!==this.model.get("editSettings").get("panel").activeSection&&this.getControlViewByName("_section_spots").ui.heading.click(),this.getControlViewByName("spots")},getSpotByIndex:function(e){return this.getSpotsView().children.findByIndex(e)},onRender:function(){n.prototype.onRender.call(this);var e=this;_.defer(function(){e.toggleSpotDragMode()})},onDestroy:function(){this.deactivateSpotDragMode(),n.prototype.onDestroy.call(this)},ui:function(){var e;return(e=n.__super__.ui.call(this)).spotHandle="> .elementor-widget-container .ha-hotspots__item",e},events:function(){var e;return(e=n.__super__.events.call(this)).contextmenu="onContextMenuOpen",e["click @ui.spotHandle"]="onClickSpot",e["dragstart @ui.spotHandle"]="openSelectedSpot",e["dragstop @ui.spotHandle"]="onDragSpotHandle",e},onContextMenuOpen:function(e){e.stopPropagation(),this.addedByContextMenuData=e},onClickSpot:function(e){e.preventDefault(),this.openSelectedSpot(e)},openSelectedSpot:function(e){e.stopPropagation(),this.model.trigger("request:edit");e=this.getSpotByIndex(e.currentTarget.getAttribute("data-index")).ui.itemTitle;e.parent().next().hasClass("editable")||e.click()},onDragSpotHandle:function(e,t){e.stopPropagation();var e=elementorFrontend.getCurrentDeviceMode(),e="desktop"===e?"":"_"+e,n=this.getEditModel().getSetting("spots"),o=t.helper,i=o.data("index"),n=n.at(i),i={},a=elementorFrontend.config.is_rtl,r=o.offsetParent().width(),s=o.offsetParent().height(),d=o.outerWidth(!0),l=t.position.left,a=a?r-l-d:l,d=t.position.top,l=n.get("x_pos"+e).unit,t=n.get("y_pos"+e).unit,a=(100*a/r).toFixed(2),d=(100*d/s).toFixed(2),u=(i["x_pos"+e]={size:a,unit:l},i["y_pos"+e]={size:d,unit:t},n.setExternalChange(i),this.renderStyles(),setTimeout(function(){o.css({top:"",left:"",right:"",bottom:"",width:"",height:""}),clearTimeout(u)},250));window.postMessage({action:"hotsopt_updated"})},activateSpotDragMode:function(){this.ui.spotHandle.draggable({addClasses:!1})},deactivateSpotDragMode:function(){this.ui.spotHandle.draggable("instance")&&this.ui.spotHandle.draggable("destroy")},toggleSpotDragMode:function(){var e="edit"===elementor.channels.dataEditMode.request("activeMode");this.deactivateSpotDragMode(),e&&elementor.userCan("design")&&this.activateSpotDragMode()}})):e}),i(window).on("message",function(e){"object"==_typeof(e.originalEvent.data)&&Reflect.has(e.originalEvent.data,"action")&&"hotsopt_updated"==Reflect.get(e.originalEvent.data,"action")&&i('* [data-setting="size"]').first().trigger("input")});function e(e,t,n){function o(e){window.postMessage("ha_cs_reinit")}t.attributes.settings.on("change",o),n.$el.on("resize",o)}elementor.hooks.addAction("panel/open_editor/widget/ha-one-page-nav",function(e,t,n){function o(){setTimeout(function(){i("#elementor-panel-content-wrapper [data-setting=select_design]").trigger("change"),i("#elementor-controls").on("click",".elementor-control-navigation_lists .elementor-repeater-add",function(){i("#elementor-panel-content-wrapper [data-setting=select_design]").trigger("change")})},500)}o(),elementor.channels.editor.on("section:activated",function(e){"_section_navigation"==e&&o()}),i("#elementor-panel-content-wrapper").on("change","[data-setting=select_design]",function(){var e,t,n;e=i(this).val(),t=elementor.panel.$el.find(".ha-opn-design-refactor-default"),n=elementor.panel.$el.find(".ha-opn-design-refactor-others-title"),"ha-opn-design-default"!=e?(t.hide(),"ha-opn-design-magool"==e?n.hide():n.show()):(t.show(),n.show())})}),elementor.hooks.addAction("panel/open_editor/column",e),elementor.hooks.addAction("panel/open_editor/content",e),elementor.hooks.addAction("panel/open_editor/section",e),elementor.channels.editor.on("haGlobalBadgeReset",function(e){var e=e.container,t=e.settings.controls,n=[];e.view.allowRender=!1;Object.entries(t).forEach(function(e){var e=_slicedToArray(e,2),t=e[0];"_ha_global_badge_section"==e[1].section&&t.includes("ha_gb")&&n.push(t),0}),$e.run("document/elements/reset-settings",{container:e,settings:n,options:{external:!0}}),e.view.allowRender=!0,e.view.$el.removeClass(function(e,t){return(t.match(/\bha-gb-\S+/g)||[]).join(" ")}),e.render()})}(jQuery);